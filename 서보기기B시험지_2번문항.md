### [문제 2 해결] 아두이노를 이용한 하드웨어 결선 및 논리식 C코드 구현 (20점)

#### (1) 하드웨어 결선도 (Hardware Connection)

> **평가 기준:** 아두이노(MCU), 홀센서 입력부, 인버터 구동 출력부의 연결 관계가 명확해야 합니다. 특히 홀센서의 풀업(Pull-up) 처리와 출력 핀이 인버터의 각 상단/하단 스위치에 매칭되는 것이 핵심입니다.

**[결선 설명 및 도식]**

1.  **입력부 (홀센서 $\rightarrow$ 아두이노):**
      * 홀센서 $H_a, H_b, H_c$의 출력 핀을 아두이노의 디지털 입력 핀에 연결합니다.
      * [cite_start]오픈 컬렉터(Open Collector) 타입의 홀센서를 가정하여, 안정적인 신호 입력을 위해 내부 풀업(`INPUT_PULLUP`)을 사용하거나 외부 풀업 저항을 연결해야 합니다[cite: 866, 2621].
2.  **출력부 (아두이노 $\rightarrow$ 게이트 드라이버/인버터):**
      * 아두이노의 디지털 출력 핀 6개를 인버터의 각 스위치($S_A^+ \sim S_C^-$) 베이스(또는 게이트) 구동 회로에 연결합니다.
      * [cite_start]제공된 자료의 회로도(`아두이노 BLDC모터 구동1.pdf` 4페이지)를 참고하여, 상단 스위치는 P형(또는 부트스트랩), 하단 스위치는 N형 소자를 구동하는 드라이버(또는 트랜지스터 베이스)로 신호를 보냅니다[cite: 890, 2673].

**[결선도 (개략도)]**

```text
       [Arduino Uno/Mega]                         [3-Phase Inverter Driver]
      +------------------+                        +-----------------------+
      |                  |                        |                       |
      |  [INPUT: Hall]   |                        |  [OUTPUT: Gate/Base]  |
      |                  |                        |                       |
      | D2 (Ha) <--------+----- Hall A Signal     | D8  --------> SA+ Base|
      | D3 (Hb) <--------+----- Hall B Signal     | D9  --------> SB+ Base|
      | D4 (Hc) <--------+----- Hall C Signal     | D10 --------> SC+ Base|
      |                  |                        |                       |
      |                  |                        | D11 --------> SA- Base|
      |                  |                        | D12 --------> SB- Base|
      |       GND -------+----- Hall GND          | D13 --------> SC- Base|
      |       5V  -------+----- Hall VCC          |                       |
      +------------------+                        +-----------------------+
```

  * *참고: 핀 번호는 문제 조건에 따라 임의로 D2\~D4(입력), D8\~D13(출력)으로 설정하였습니다.*

-----

#### (2) 홀 입력신호와 게이트 구동 출력 신호의 논리식 C코드 구현

> **평가 기준:** 1번 문제의 (4)항에서 유도한 **60도 간격 홀센서 기준 반시계방향(CCW) 논리식**을 정확한 C언어 문법(`digitalRead`, `digitalWrite`, 논리연산자 `&&`, `!`)으로 변환해야 합니다.

**[논리식 리마인드 (1번 문제 결과)]**

  * $S_A^+ = H_a \cdot H_b$
  * $S_B^+ = \overline{H_b} \cdot \overline{H_c}$
  * $S_C^+ = \overline{H_a} \cdot H_c$
  * $S_A^- = \overline{H_a} \cdot \overline{H_b}$
  * $S_B^- = H_b \cdot H_c$
  * $S_C^- = H_a \cdot \overline{H_c}$

**[아두이노 C코드]**

```c
// 1. 핀 번호 정의 (임의 결정)
// Hall Sensor Inputs
const int HA_PIN = 2;
const int HB_PIN = 3;
const int HC_PIN = 4;

// Gate Drive Outputs (High Side)
const int SA_P_PIN = 8;  // SA+
const int SB_P_PIN = 9;  // SB+
const int SC_P_PIN = 10; // SC+

// Gate Drive Outputs (Low Side)
const int SA_N_PIN = 11; // SA-
const int SB_N_PIN = 12; // SB-
const int SC_N_PIN = 13; // SC-

// 변수 선언
int ha, hb, hc;

void setup() {
  // 2. 핀 모드 설정
  [cite_start]// 홀센서는 풀업 저항을 사용하여 플로팅 방지 [cite: 866]
  pinMode(HA_PIN, INPUT_PULLUP);
  pinMode(HB_PIN, INPUT_PULLUP);
  pinMode(HC_PIN, INPUT_PULLUP);

  [cite_start]// 출력 핀 설정 [cite: 1494]
  pinMode(SA_P_PIN, OUTPUT);
  pinMode(SB_P_PIN, OUTPUT);
  pinMode(SC_P_PIN, OUTPUT);
  pinMode(SA_N_PIN, OUTPUT);
  pinMode(SB_N_PIN, OUTPUT);
  pinMode(SC_N_PIN, OUTPUT);
}

void loop() {
  [cite_start]// 3. 홀 센서 값 읽기 (1 or 0) [cite: 1160]
  ha = digitalRead(HA_PIN);
  hb = digitalRead(HB_PIN);
  hc = digitalRead(HC_PIN);

  // 4. 논리식 구현 (1번 문제의 CCW 60도 간격 논리 적용)
  // 논리곱(AND)은 '&&', 부정(NOT)은 '!' 연산자 사용

  // --- 상단 스위치 (High Side) ---
  // SA+ = Ha AND Hb
  digitalWrite(SA_P_PIN, (ha && hb));

  // SB+ = (NOT Hb) AND (NOT Hc) -> 000 상태 대응
  digitalWrite(SB_P_PIN, (!hb && !hc));

  // SC+ = (NOT Ha) AND Hc
  digitalWrite(SC_P_PIN, (!ha && hc));

  // --- 하단 스위치 (Low Side) ---
  // SA- = (NOT Ha) AND (NOT Hb)
  digitalWrite(SA_N_PIN, (!ha && !hb));

  // SB- = Hb AND Hc -> 111 상태 대응
  digitalWrite(SB_N_PIN, (hb && hc));

  // SC- = Ha AND (NOT Hc)
  digitalWrite(SC_N_PIN, (ha && !hc));
}
```

-----

**[답안 작성 팁]**

  * **코드 주석 활용:** 코드 내에 `// SA+ = Ha AND Hb`와 같이 주석을 달아주면, 1번 문제에서 유도한 논리식을 그대로 코드로 옮겼음을 채점자에게 명확히 보여줄 수 있습니다.
  * [cite_start]**자료와의 연계:** 제공된 자료(`BLDCM_drivercontrol.pdf`)에서는 `state` 변수를 만들어 `if-else`문으로 처리했지만[cite: 1170, 1173], 이 문제는 \*\*"게이트로 구현한 것을 대치"\*\*하라고 했으므로 위와 같이 **불리언 논리식(Boolean Logic)을 직접 `digitalWrite`에 대입하는 방식**이 출제 의도에 더 부합하며 간결한 정답입니다.
  * **60도 배치 특성:** 일반적인 120도 배치 코드와 달리 `!hb && !hc` (000 상태)와 `hb && hc` (111 상태)가 유효한 구동 신호로 사용됨을 보여주는 것이 고득점 포인트입니다.
